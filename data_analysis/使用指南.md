# 📊 数据分析模块使用指南

## 模块结构

```
data_analysis/
├── visualization/          # 数据可视化（5个图表脚本）
│   ├── 折线图_时间序列.py
│   ├── 柱状图_分组对比.py
│   ├── 散点图_相关性分析.py
│   ├── 热力图_相关矩阵.py
│   └── 平行坐标图_高维数据.py
│
├── preprocessing/          # 数据预处理（3个处理脚本）
│   ├── 缺失值处理.py
│   ├── 异常值处理.py
│   └── 特征标准化.py
│
└── utils/                  # 工具函数（3个工具脚本）
    ├── 数据读取工具.py
    ├── 评估指标.py
    └── 时间处理.py
```

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install pandas numpy matplotlib seaborn scikit-learn scipy
```

### 2. 选择你需要的模块

#### 场景1: 数据可视化
```bash
cd data_analysis/visualization
python 折线图_时间序列.py
```

#### 场景2: 数据预处理
```bash
cd data_analysis/preprocessing
python 缺失值处理.py
```

#### 场景3: 使用工具函数
```bash
cd data_analysis/utils
python 数据读取工具.py
```

## 📊 完整的数据分析流程

### 标准工作流程

```
1. 数据读取 → 2. 数据预处理 → 3. 特征工程 → 4. 模型训练 → 5. 结果可视化
```

### 详细步骤

#### 第1步: 读取数据

```python
from data_analysis.utils.数据读取工具 import read_file_auto, quick_preview

# 读取数据
data = read_file_auto('your_data.csv')

# 快速预览
quick_preview(data)
```

#### 第2步: 处理缺失值

```bash
cd data_analysis/preprocessing
python 缺失值处理.py
```

或在代码中：
```python
from sklearn.impute import KNNImputer
imputer = KNNImputer(n_neighbors=5)
data_filled = imputer.fit_transform(data)
```

#### 第3步: 处理异常值

```bash
python 异常值处理.py
```

#### 第4步: 特征标准化

```bash
python 特征标准化.py
```

或在代码中：
```python
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
data_scaled = scaler.fit_transform(data)
```

#### 第5步: 可视化分析

```bash
cd data_analysis/visualization

# 选择合适的图表
python 热力图_相关矩阵.py      # 特征相关性分析
python 散点图_相关性分析.py    # 变量关系分析
python 柱状图_分组对比.py      # 模型性能对比
```

## 💡 典型应用场景

### 场景1: 用户行为分析（C题常见）

**数据特点**: 有缺失值，量纲差异大，需要时间特征

**处理流程**:

```python
# 1. 读取数据
from 数据读取工具 import read_file_auto
data = read_file_auto('user_behavior.csv')

# 2. 处理缺失值（运行脚本）
# cd preprocessing && python 缺失值处理.py

# 3. 提取时间特征
from 时间处理 import extract_datetime_features
data = extract_datetime_features(data, '访问时间')

# 4. 特征标准化（运行脚本）
# python 特征标准化.py

# 5. 可视化分析（运行脚本）
# cd visualization && python 热力图_相关矩阵.py
```

### 场景2: 推荐系统评估

**需求**: 对比多个推荐算法的性能

**处理流程**:

```python
# 1. 训练多个模型，得到预测结果

# 2. 评估每个模型
from 评估指标 import evaluate_classification, plot_confusion_matrix

for model_name, y_pred in models.items():
    metrics = evaluate_classification(y_test, y_pred)
    plot_confusion_matrix(y_test, y_pred, save_path=f'{model_name}.png')

# 3. 可视化对比
# cd visualization && python 柱状图_分组对比.py
```

### 场景3: 时间序列预测

**需求**: 预测未来趋势，展示置信区间

**处理流程**:

```bash
# 1. 处理时间数据
cd utils
python 时间处理.py

# 2. 训练预测模型

# 3. 可视化预测结果
cd visualization
python 折线图_时间序列.py  # 修改数据部分，添加预测值和置信区间
```

## 📝 各模块详细说明

### 📊 visualization/ - 数据可视化

| 脚本 | 用途 | O奖要点 |
|-----|------|---------|
| 折线图_时间序列 | 趋势分析、预测展示 | ✅ 置信区间 |
| 柱状图_分组对比 | 多模型性能对比 | ✅ 数值标注 |
| 散点图_相关性分析 | 变量关系分析 | ✅ R²和拟合线 |
| 热力图_相关矩阵 | 特征相关性 | ✅ 相关系数 |
| 平行坐标图_高维数据 | 客户分群、帕累托前沿 | ✅ 数据标准化 |

**详细文档**: `visualization/README.md`

### 🔧 preprocessing/ - 数据预处理

| 脚本 | 功能 | 推荐方法 |
|-----|------|---------|
| 缺失值处理 | 填充/删除缺失数据 | KNN填充 |
| 异常值处理 | 检测/处理离群点 | Isolation Forest |
| 特征标准化 | 消除量纲影响 | Z-score标准化 |

**处理顺序**: 缺失值 → 异常值 → 标准化

**详细文档**: `preprocessing/README.md`

### 🛠️ utils/ - 工具函数

| 脚本 | 功能 | 常用函数 |
|-----|------|---------|
| 数据读取工具 | 读取各种格式 | `read_file_auto()` |
| 评估指标 | 模型性能评估 | `evaluate_classification()` |
| 时间处理 | 日期时间处理 | `extract_datetime_features()` |

**详细文档**: `utils/README.md`

## ⚠️ 重要提醒

### 1. 数据分割顺序

```python
# ✅ 正确做法
from sklearn.model_selection import train_test_split

# 先分割
X_train, X_test = train_test_split(X, test_size=0.2)

# 在训练集上fit
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)

# 在测试集上只transform
X_test_scaled = scaler.transform(X_test)  # 不要fit！
```

### 2. 保存预处理模型

```python
import joblib

# 保存标准化器
joblib.dump(scaler, 'scaler.pkl')

# 加载并使用
scaler = joblib.load('scaler.pkl')
new_data_scaled = scaler.transform(new_data)
```

### 3. 中文显示问题

如果图表中文显示乱码，在脚本开头修改：

```python
# Mac系统
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS']

# Windows系统
plt.rcParams['font.sans-serif'] = ['SimHei']
```

## 🎯 快速查找指南

### 我想做什么？ → 用哪个脚本？

| 需求 | 使用脚本 |
|-----|---------|
| 读取CSV/Excel | `utils/数据读取工具.py` |
| 处理缺失值 | `preprocessing/缺失值处理.py` |
| 处理异常值 | `preprocessing/异常值处理.py` |
| 特征标准化 | `preprocessing/特征标准化.py` |
| 提取时间特征 | `utils/时间处理.py` |
| 评估模型性能 | `utils/评估指标.py` |
| 展示时间趋势 | `visualization/折线图_时间序列.py` |
| 对比模型性能 | `visualization/柱状图_分组对比.py` |
| 分析变量关系 | `visualization/散点图_相关性分析.py` |
| 特征筛选 | `visualization/热力图_相关矩阵.py` |
| 客户分群 | `visualization/平行坐标图_高维数据.py` |

## 📚 学习资源

- **各模块README**: 每个模块文件夹都有详细的README.md
- **脚本注释**: 所有脚本都有详细的中文注释
- **运行示例**: 每个脚本都可以直接运行查看效果

## 🆘 常见问题

**Q: 如何修改脚本中的数据？**  
A: 找到 `# 生成示例数据` 部分，替换成你的数据

**Q: 图表保存在哪里？**  
A: 默认保存在脚本运行的当前目录

**Q: 如何批量处理多个文件？**  
A: 使用循环调用工具函数，或修改脚本的数据读取部分

**Q: 缺少某个库怎么办？**  
A: 运行 `pip install 库名`，常用库见各模块README

## ✨ 特点总结

- ✅ **直接运行**: 所有脚本都可以独立运行
- ✅ **中文注释**: 每个参数都有详细说明
- ✅ **O奖标准**: 符合美赛高分论文要求
- ✅ **即改即用**: 只需替换数据部分

---

**祝你在美赛中取得优异成绩！🏆**

